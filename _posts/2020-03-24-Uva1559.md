---
title: Uva 01559  Nim
---


## Input

```

Lets play a traditional game Nim. You and I are seated across a table and we have a hundred stones
on the table (we know the number of stones exactly). We play in turn and at each turn, you or I can
remove one to four stones from the heap. You play first and the one who removed the last stone loses.

In this game, you have a winning strategy. To see this, you first remove four stones and leave 96
stones. No matter how I play, I will end up with leaving between 92 and 95 stones. Then you will in
turn leave 91 stones for me (verify this is always possible). This way, you can always leave 5k+1 stones
for me and finally I get the last stone, sigh. If we initially had 101 stones, on the other hand, I have a
winning strategy and you are doomed to lose.

Lets generalize the game a little bit. First, lets make it a team game. Each team has n players
and the 2n players are seated around the table, with each player having opponents at both sides. Turns
round the table so the two teams play alternately. Second, lets vary the maximum number ofstones
each player can take. That is, each player has his/her own maximum number ofstones he/she can take
at each turn (The minimum is always one). So the game is asymmetric and may even be unfair.

In general, when played between two teams of experts, the outcome of a game is completely deter-
mined by the initial number ofstones and the minimum number of stones each player can take at each
turn. In other words, either team has a winning strategy.

You are the head-coach of a team. In each game, the umpire shows both teams the initial number
of stones and the maximum number of stones each player can take at each turn. Your team plays first.
Your job is, given those numbers, to instantaneously judge whether your team has a winning strategy.

Incidentally, there is a rumor that Captain Future and her officers of Hakodate-maru love this game,
and they are killing their time playing it during their missions. You wonder where the stones are?. Well,
they do not have stones but do have plenty of balls in the fuel containers!.
```

## Output

```
The input is a sequence of lines, followed by the last line containing a zero. Each line except the last
is a sequence of integers and has the following format.

n S M1 M2    M2n

where n is the number of players in a team, S the initial number of stones, andMi the maximum number
of stones ith player can take. 1st, 3rd, 5th,    players are your teams players and 2nd, 4th, 6th,   
the opponents. Numbers are separated by a single space character. You may assume 1  n  10,
1  Mi  16, and 1  S < 213.

```

## Sample Input

```
The out put should consist of lines each containing either a one, meaning your team has a winning
strategy, or a zero otherwise.

```

## Sample Output

```
1 101 4 4

1 100 4 4

3 97 8 7 6 5 4 3

O



Universidad de Valladolid OJ: 1559  Nim 2/2

```
