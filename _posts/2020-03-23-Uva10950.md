---
title: Uva 10950  Bad Code
---

10950 Bad Code
In his endless attempt to keep his secret documents safe, Bob has designed yet another coding system.
In this system, every character is replaced by a unique positive integer value – which we call the code
for a character. However, this system – as expected – is not the best in the world. So more than one
plain text can result in the same encrypted string. Here are a few more notes:

• The document consists exclusively of lower-case letters.

• The code for a letter is no more than 99.

• The encrypted string does not contain more than 100 characters.

• A code may or may not be preceded by a 0 in the encrypted string (note the 2nd sample test
case).

Given the codes for each character and the encrypted string, you have to find all the plain text
strings in alphabetical order that produces that encrypted string.

## Input

There will be no more than 500 test cases. Each test case starts with an integer N , which gives the
number of unique characters in the document. Each of next N lines contains a character in the letter
and its code. The last line in the test case gives the encrypted string. The last test case will have
N = 0. This last test case need not be processed.

## Output

For each test case, print the test case number and the possible plain texts for the given encrypted string.
If there is more than 100 possible strings report only the first 100 strings. Print a blank line after the
output for each test case.

## Sample Input
<p></p><p>5</p><p>a 12</p><p>b 1</p><p>c 2</p><p>d 3</p><p>e 23</p><p>123</p><p>2</p><p>o 10</p><p>x 1</p><p>1010101</p><p>0</p><p></p><p></p><p></p><p>Universidad de Valladolid OJ: 10950 – Bad Code 2/2</p><p></p>

## Sample Output
<p>Case #1</p><p>ad</p><p>bcd</p><p>be</p><p></p><p>Case #2</p><p>ooox</p><p>ooxx</p><p>oxox</p><p>oxxx</p><p>xoox</p><p>xoxx</p><p>xxox</p><p>xxxx</p>